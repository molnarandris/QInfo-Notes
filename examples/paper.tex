\documentclass{article}
\usepackage[utf8]{inputenc}
\usepackage{fullpage}
\usepackage{amsthm,amsmath,amssymb}
\usepackage{tikz}
\usepackage[hidelinks,draft=false,colorlinks=true]{hyperref}
\usepackage[capitalize]{cleveref} % after hyperref!
\usepackage{mathtools}  % for extendible arrows with text above 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% For bibliography
\usepackage[sorting=none, backend=biber, url=false, isbn=false, hyperref=true, eprint=true, maxbibnames=6]{biblatex}
\addbibresource{/home/molnar/Dropbox/ZoteroLibrary.bib}
\AtEveryBibitem{%
	\clearfield{eprintclass}%
}

% Setting title to point to doi link
\ExecuteBibliographyOptions{doi=false}
\newbibmacro{string+doi}[1]{%
	\iffieldundef{doi}{#1}{\href{http://dx.doi.org/\thefield{doi}}{#1}}}
\DeclareFieldFormat{title}{\usebibmacro{string+doi}{\mkbibemph{#1}}}
\DeclareFieldFormat[article]{title}{\usebibmacro{string+doi}{\mkbibquote{#1}}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% hyperref setup
\hypersetup{
	pdftitle={Quantum information lecture notes},
	pdfauthor={Andras Molnar},
	bookmarks=true,
	bookmarksnumbered=true,
	bookmarksopen=true,
	bookmarksopenlevel=1,
	colorlinks,
	%linkcolor=blue!50!black,
	%urlcolor=cyan!50!black!90,
	pdfstartview=Fit,
	pdfpagemode=UseOutlines,    
	pdfpagelayout=TwoPageRight
}

\newtheorem{lemma}{Lemma}
\newtheorem{fact}{Fact}
\newtheorem{proposition}{Proposition}
\newtheorem{theorem}{Theorem}
\newtheorem{corollary}{Corollary}
\newtheorem{remark}{Remark}
\newtheorem{definition}{Definition}
\newtheorem{exercise}{Exercise}
\theoremstyle{definition}
\newtheorem{example}{Example}


\newcommand{\tr}{\operatorname{Tr}}
\newcommand{\id}{\mathrm{Id}}
\newcommand{\todo}[1]{{\color{red} #1}}
\newcommand{\myfcn}{nice }
\newcommand{\myfcntwo}{admissible }
\newcommand{\End}{\mathrm{End}}
\newcommand{\ket}[1]{\vert #1 \rangle}
\newcommand{\bra}[1]{\langle #1 \vert}
\newcommand{\scalprod}[2]{\langle #1 \vert #2 \rangle}
\newcommand{\Span}{\mathrm{Span}}
\newcommand{\bounded}[1]{\mathcal{B}(#1)}

\title{Quantum Information}
\author{Andras Molnar}

\begin{document}

\maketitle

\begin{remark}
  In this note all Hilbert spaces are complex and finite dimensional unless otherwise stated.
\end{remark}


\section{Introduction}

\subsection{Bra-ket notation}
Let $V$ be an $d$-dimensional vector space. For any vector $v\in V$ we will (usually) write $\ket{v}$ instead of $v$, and read \emph{ket}-$v$. When we are doing calculations, we have to fix a basis $v_0, v_1 , \dots, v_{d-1}$, or in ket notation, $\ket{v_0}, \dots , \ket{v_{d-1}}$. This specific basis is then referred to as the \emph{computational basis}.  As we refer to these vectors a lot of time, we simply write $\ket{0}, \dots, \ket{d-1}$ instead of $\ket{v_0}, \dots , \ket{v_{d-1}}$.  That is, we can write every vector $\ket{v}\in V$ as
\begin{equation}\label{eq:vector_decomp}
  \ket{v} = v_0 \ket{0} + v_1 \ket{1} +\dots v_{d-1} \ket{d-1},
\end{equation} 
with $v_0, \dots, v_{d-1}\in \mathbb{C}$ numbers that are uniquely determined by $\ket{v}$ and our choice of the basis. As usual, we can write this equation in matrix notation; we will think of vectors as column vectors. The computational basis in this notation is given by
\begin{equation*}
  \ket{0} = \begin{pmatrix} 1 \\ 0 \\ \vdots \\ 0 \end{pmatrix}, \quad 
  \ket{1} = \begin{pmatrix} 0 \\ 1 \\ \vdots \\ 0 \end{pmatrix}, \quad \text{...,} \quad
  \ket{d-1} = \begin{pmatrix} 0 \\ 0 \\ \vdots \\ 1 \end{pmatrix},
\end{equation*}
and \cref{eq:vector_decomp} becomes 
\begin{equation*}
    \ket{v} = v_0 \ket{0} + v_1 \ket{1} +\dots v_{d-1} \ket{d-1} = v_0 \ \begin{pmatrix} 1 \\ 0 \\ \vdots \\ 0 \end{pmatrix}+ v_1\ 
      \begin{pmatrix} 0 \\ 1 \\ \vdots \\ 0 \end{pmatrix} + \dots + v_{d-1}\ \begin{pmatrix} 0 \\ 0 \\ \vdots \\ 1 \end{pmatrix} =  \begin{pmatrix} v_0 \\ v_1 \\ \vdots \\ v_{d-1} \end{pmatrix}.
\end{equation*}
Given two different vector spaces $V$ and $W$, of dimension $n$ and $m$, respectively, both of their computational basis is denoted the same way: $\ket{0}, \ldots, \ket{n-1}$, and $\ket{0},\ldots, \ket{m-1}$. Notice that $\ket{0}$ denotes two different vectors in two different vector spaces: once $\ket{0}\in V$, and once $\ket{0}\in W$. It usually is clear from the context which vector we are referring to; if confusion arises, we can specify the vector space by attaching an extra subscript to the ket notation; for example, we could write $\ket{0}_V \in V$ and $\ket{0}_W\in W$.

Linear operators act from the left: $A: V\to W$ acts as $\ket{v}\mapsto A\ket{v} \equiv \ket{Av}$. Due to linearity $A$ is uniquely determined by its action on the basis vectors. We write $A\ket{i}_V = \sum_{j} A_{ji} \ket{j}_W$; as usual, we can think of $A$ as a matrix, where the $k^{th}$ column is the vector $A\ket{k-1}$:
\begin{equation*}
  A = \begin{pmatrix} A\ket{0} & A\ket{1} & \cdots & A\ket{n-1} \end{pmatrix} = 
  \begin{pmatrix}
    A_{00} & A_{01} & \cdots & A_{0, {n-1}} \\
    A_{10} & A_{11} & \cdots & A_{1, {n-1}} \\
    \vdots & \vdots & \ddots & \vdots \\
    A_{m-1,0} & A_{m-1,1} & \cdots & A_{m-1, {n-1}} \\    
  \end{pmatrix}
\end{equation*}
Then the action of $A$ on the vector $v$ is described by the usual matrix-vector multiplication: $A\ket{v} = \sum_{i} A v_i \ket{i} = \sum_{ji} A_{ji} v_i \cdot \ket{j}$, i.e., 
\begin{equation*}
  A \ket{v} = 
  \begin{pmatrix}
    A_{00} & A_{01} & \cdots & A_{0, {n-1}} \\
    A_{10} & A_{11} & \cdots & A_{1, {n-1}} \\
    \vdots & \vdots & \ddots & \vdots \\
    A_{m-1,0} & A_{m-1,1} & \cdots & A_{m-1, {n-1}} \\    
  \end{pmatrix} \cdot \begin{pmatrix} v_0 \\ v_1 \\ \vdots \\ v_{n-1} \end{pmatrix} = 
  \begin{pmatrix} \sum_i A_{0i} v_i \\ \sum_i A_{1i}v_i \\ \vdots \\ \sum_i A_{m-1,i}v_{i} \end{pmatrix}.
\end{equation*}
 {\color{red} LINEAR FUNCTIONALS; decomposing a matrix into ...
}
\begin{itemize}
  \item Bra and ket
  \item Scalar product
  \item Adjoint
  \item Eigenvalues
\end{itemize}

\subsection{Positivity}

\begin{definition}[Positivity]
  A matrix $A\in \bounded{\mathcal{H}}$ is \emph{positive semidefinite} if $\bra{\Psi} A\ket{\Psi} \geq 0$ for all $\ket{\Psi}\in\mathcal{H}$. It is \emph{positive definite} if $\bra{\Psi} A\ket{\Psi} > 0$ for all $\ket{\Psi}\in\mathcal{H}$. 
\end{definition}

\begin{theorem}
  Let $\mathcal{H}$ be a Hilbert space, $A\in\bounded{\mathcal{H}}$ be a matrix. The following are equivalent.
  \begin{itemize}
    \item $A$ is positive semidefinite (positive definite)
    \item $A$ is Hermitian and it has only non-negative (positive) eigenvalues
    \item There is a(n invertible) matrix $X\in \bounded{\mathcal{H}}$ such that $A = X^\dagger X$.
  \end{itemize}
\end{theorem}

\begin{proof}
  Exercise.
\end{proof}

\subsection{Tensor product}

\subsubsection{The maximally entangled state}

Let $\mathcal{H} = \mathbb{C}^d$ and consider the state $\ket{\Omega} = \frac{1}{\sqrt{d}}\sum_{i=0}^{d-1} \ket{ii}\in\mathcal{H}\otimes\mathcal{H}$. This state is called the maximally entangled state and it has the following properties.


\begin{proposition}\label{prop:max_ent_partial_tr}
  \begin{equation*}
    (\id \otimes \tr )(\ket{\Omega}\bra{\Omega}) = (\tr \otimes\id)(\ket{\Omega}\bra{\Omega})  = \id.
  \end{equation*}
\end{proposition}

\begin{proof}
  Explicit calculation; exercise.
\end{proof}

\begin{proposition}\label{prop:max_ent_pull_through}
  Let $A\in\mathcal{M}_d$ be any square matrix, then 
  \begin{equation*}
     (A \otimes \id) \ket{\Omega} = (\id\otimes A^T) \ket{\Omega}.
  \end{equation*}
\end{proposition}
\begin{proof}
   Exercise: explicit calculation.
\end{proof}
More generally, let $d$ and $D$ be natural numbers, $\ket{\Omega_d}$ and $\ket{\Omega_D}$ be the $d$- and the $D$ dimensional maximally entagled states. Then
\begin{proposition}
  Let $A\in\mathcal{M}_{d\times D}$ be a $d\times D$ matrix, then 
  \begin{equation*}
    (A \otimes \id) \ket{\Omega_D} = (\id\otimes A^T) \ket{\Omega_d}.
  \end{equation*}
\end{proposition}
\begin{proof}
  Exercise: explicit calculation.
\end{proof}
A special case of this equation is if $d=1$. Then $\ket{\Omega_d} \in \mathbb{C}^d\otimes \mathbb{C}^d \simeq \mathbb{C}$ is just $1$, and the $d\times D$ matrix is just a linear functional. Writing out this case explicitly, we obtain 
\begin{proposition}\label{prop:max_ent_pull_through_lin_fcn}
  Let $\ket{\Psi}\in\mathbb{C}^{d}$ and $\ket{\Omega}\in \mathbb{C}^d \otimes \mathbb{C}^d$ be the maximally entangled state. Then 
  \begin{equation*}
    (\bra{\Psi} \otimes \id) \ket{\Omega} = \ket{\bar{\Psi}},
  \end{equation*}
  the complex conjugate of $\ket{\Psi}$.
\end{proposition}
\begin{proof}
  Exercise: explicit calculation.
\end{proof}


\section{Quantum mechanics}

\subsection{The rules of quantum mechanics}
 \begin{itemize}
   \item States
   \item Time evolution
   \item Measurements: destructive, then projective
 \end{itemize}
 
\subsection{The rules of quantum mechanics: mixed states}
\begin{itemize}
  \item Mixed states
  \item POVMs
  \item CP maps
\end{itemize}


\begin{definition}[Ensemble]
  Let $\mathcal{H}$ be a Hilbert space. En \emph{ensemble} is a collection of normalized vectors with probabilities: it is given by $n\in\mathbb{N}$ and $\big((p_i, \ket{\Psi_i})\big)_{i=1}^n \subseteq (\mathbb{R}_{\geq 0} \times \mathcal{H})^n$ such that $\|\Psi_i\| = 1$ for all $i=1,\dots,n$ and $\sum_{i=1}^n p_i = 1$.
\end{definition}
\subsubsection{Mixed states}

\begin{definition}[Density matrix]
  Let $\mathcal{H}$ be a Hilbert space. A \emph{state} or a \emph{density matrix} on $\mathcal{H}$ is a matrix $\rho\in\bounded{\mathcal{H}}$ such that $\tr\rho = 1$, and $\rho\geq 0$, i.e., it is positive semidefinite. The state $\rho$ is called \emph{pure} if it is rank-one. 
\end{definition}

\begin{proposition}
  Let $\mathcal{H}$ be a Hilbert space and $\rho\in\bounded{\mathcal{H}}$ be a pure state. Then there is $\ket{\Psi}\in\mathcal{H}$, $\|\Psi\| = 1$, such that $\rho  = \ket{\Psi} \bra{\Psi}$.
\end{proposition}

\begin{proof}
   $\rho$ is rank-one and Hermitian, thus it can be written as $\rho = \ket{\Psi}\bra{\Psi}$. $\tr \rho = \tr\ket{\Psi} \bra{\Psi} = \scalprod{\Psi}{\Psi} = \|\Psi\|^2 = 1$.
\end{proof}





\subsubsection{CP maps}

\begin{definition}
    Let $\mathcal{H}$ and $\mathcal{K}$ be two Hilbert spaces. Let $T:\bounded{\mathcal{H}}\to\bounded{\mathcal{K}}$ be linear. We say that $T$ is \emph{trace preserving} if $\tr T(\rho) = \tr \rho$, for all $\rho\in\bounded{\mathcal{H}}$.
\end{definition}

\begin{definition}
  Let $\mathcal{H}$ and $\mathcal{K}$ be two Hilbert spaces. Let $T:\bounded{\mathcal{H}}\to\bounded{\mathcal{K}}$ be linear. We say that $T$ is a Kraus map if there are $A_i\in \mathcal{B}(\mathcal{H}\rightarrow \mathcal{K})$ such that 
  \begin{equation}\label{eq:Kraus_decomp_def}
    T(\rho) = \sum_{i=1}^n A_i \rho A_i^\dagger.
  \end{equation}
  The operators $A_i$ are called the Kraus operators, and \cref{eq:Kraus_decomp_def} the Kraus representation of $T$.
\end{definition}

\begin{proposition}
    Let $\mathcal{H}$ and $\mathcal{K}$ be two Hilbert spaces. Let $T:\bounded{\mathcal{H}}\to\bounded{\mathcal{K}}$ be a Kraus map with Kraus operators $\{A_i\}_{i=1}^n$. Then $T$ is trace preserving iff $\sum_i A_i^\dagger A_i = \id_{\mathcal{H}}$.
\end{proposition}
\begin{proof}
  Exercise.
\end{proof}

\begin{definition}
  Let $\mathcal{H}$ and $\mathcal{K}$ be two Hilbert spaces. Let $T:\bounded{\mathcal{H}}\to\bounded{\mathcal{K}}$ be linear. We say that 
  \begin{itemize}
    \item $T$ is \emph{positivity preserving}, or simply \emph{positive}, if $T(\rho)\geq 0$ for all $\rho\in\bounded{\mathcal{H}}$. 
    \item $T$ is $n$-positive if $T\otimes\id: \bounded{\mathcal{H}}\otimes\bounded{\mathbb{C}^n} \to \bounded{\mathcal{H}} \otimes \bounded{\mathbb{C}^n}$ is positive.
    \item $T$ is \emph{completely positive (CP)} if it is $n$-positive for all $n\in\mathbb{N}$.
  \end{itemize}
\end{definition}

\begin{theorem}
   Let $\mathcal{H}$ and $\mathcal{K}$ be two Hilbert spaces, and $\ket{\Omega}\in\mathcal{H}\otimes\mathcal{H}$ be a maximally entangled state. Let $T:\bounded{\mathcal{H}}\to\bounded{\mathcal{K}}$ be linear. The following are equivalent:
   \begin{enumerate}
        \item $T$ is completely positive. \label{CP_Kraus_thm_1}
        \item $T$ is $\dim(H)$-positive. \label{CP_Kraus_thm_2}
        \item $(\id\otimes T)(\ket{\Omega}\bra{\Omega}) \geq 0$. \label{CP_Kraus_thm_3} 
        \item $T$ is Kraus. \label{CP_Kraus_thm_4}
   \end{enumerate}
\end{theorem}
\begin{proof}
  The implication \ref{CP_Kraus_thm_1} $\Rightarrow$ \ref{CP_Kraus_thm_2} $\Rightarrow$ \ref{CP_Kraus_thm_3} is by definition. To check \ref{CP_Kraus_thm_3} $\Rightarrow$ \ref{CP_Kraus_thm_4}, note that 
  \begin{equation*}
    T(\rho) = (\tr \otimes T) ((\id \otimes \rho ) \ket{\Omega}\bra{\Omega}) = (\tr \otimes T) ((\rho^T \otimes \id ) \ket{\Omega}\bra{\Omega}) = (\tr\otimes \id) ((\rho^T \otimes \id) X),
  \end{equation*}
  where $X = (\id\otimes T)(\ket{\Omega}\bra{\Omega})\geq 0$. As $X\geq 0$, we can write it as $\sum_i \ket{\Psi_i}\bra{\Psi_i}$ for some (unnormalized) vectors $\ket{\Psi_i}\in \mathcal{H}\otimes\mathcal{K}$. But $\ket{\Psi_i}$ then in turn can be written as $(\id \otimes A_i)\ket{\Omega}$, and thus $X$ can be written as 
  \begin{equation*}
    X = \sum_i (\id \otimes A_i) \ket{\Omega}\bra{\Omega} (\id \otimes A_i^\dagger). 
  \end{equation*} 
  Therefore 
  \begin{equation*}
    T(\rho) = (\tr\otimes \id) ((\rho^T \otimes \id) X) = \sum_i (\tr \otimes\id) ((\rho^T \otimes A_i) \ket{\Omega}\bra{\Omega} (\id\otimes A_i^\dagger)).
  \end{equation*}
  Using now \cref{prop:max_ent_pull_through} in the form  $(\rho^T \otimes \id)\ket{\Omega} = (\id\otimes \rho) \ket{\Omega}$, and \cref{prop:max_ent_partial_tr}, we obtain 
  \begin{equation*}
    T(\rho) = \sum_i (\tr \otimes\id) ((\id\otimes A_i \rho) \ket{\Omega}\bra{\Omega} (\id\otimes A_i^\dagger)) = \sum_i A_i \rho A_i^\dagger.
  \end{equation*}
  Finally to check \ref{CP_Kraus_thm_4} $\Rightarrow$ \ref{CP_Kraus_thm_1}, let the Kraus operators of $T$ be $A_i$, $n\in\mathbb{N}$ arbitrary, and $\rho\in\bounded{\mathcal{H}}\otimes \bounded{\mathbb{C}^n}$ be positive. Then
    \begin{equation*}
      (T\otimes \id_{\bounded{\mathbb{C}^n}})(\rho) = \sum_i (A_i \otimes \id_{\mathbb{C}^n}) \rho (A_i^\dagger \otimes \id_{\mathbb{C}^n} ) \geq 0,
    \end{equation*}
    i.e., $T$ is completely positive.  
\end{proof}


\begin{proposition}
  The transposition map is positive but not completely positive.
\end{proposition}
\begin{proof}
  Exercise.
\end{proof}

\section{Entanglement}

\begin{definition}[Entanglement of pure states]
  A pure state $\ket{\Psi}\in \mathcal{H}\otimes\mathcal{K}$ is called entangled if it is not a product.
\end{definition}

\begin{definition}[Separability and entanglement]
  A state $\rho \in \bounded{\mathcal{H}} \otimes \bounded{\mathcal{K}}$ is called \emph{separable} if there are density matrices $\mu_i\in \bounded{\mathcal{H}}$, $\nu_i\in\bounded{\mathcal{H}}$, $i=1\dots n$, and a probability distribution $p\in\mathbb{R}^n$ such that
  \begin{equation*}
    \rho = \sum_{i=1}^n p_i \cdot \mu_i \otimes \nu_i.    
  \end{equation*}
  The state $\rho$ is called \emph{entangled} if it is not separable.
\end{definition}

\begin{proposition}
  Let $\mathcal{H}$ and $\mathcal{K}$ be Hilbert spaces, $\rho\in\bounded{\mathcal{H}}\otimes\bounded{\mathcal{K}}$ be a \emph{separable} state.  Let $T$ be a positive but not necessarily CP map. Then $(\id\otimes T)(\rho)\geq 0$.
\end{proposition}
\begin{proof}
  As $\rho$ is separable, there are density matrices $\mu_i\in \bounded{\mathcal{H}}$, $\nu_i\in\bounded{\mathcal{H}}$, $i=1\dots n$, and a probability distribution $p\in\mathbb{R}^n$ such that
    \begin{equation*}
      \rho = \sum_{i=1}^n p_i \cdot \mu_i \otimes \nu_i.    
    \end{equation*}
    Then 
    \begin{equation*}
      (\id\otimes T)(\rho) = \sum_{i=1}^n p_i \cdot \mu_i \otimes T(\nu_i) \geq 0,    
    \end{equation*}
    as $p_i$, $\mu_i$ and $T(\nu_i)$ are all positive.
\end{proof}

This can be used to detect entanglement: if $T$ is a positive but not necessarily CP map, and $\rho$ is a density matrix in a bipartite space, then if $(\id\otimes T)(\rho)\ngeq 0$, then we can conclude, apart from the fact that $T$ is not CP, that $\rho$ is entangled. A standard example is the transposition map.

\section{Teleportation and dense coding}

Let us assume that Alice and Bob share a maximally entangled state $\ket{\Omega}\in \mathbb{C}^2 \otimes \mathbb{C}^2$. Assume Alice has an additional, unknown, state $\ket{\Psi}\in\mathbb{C}^2$. Quantum state teleportation is a protocol where Alice transfers the state $\ket{\Psi}$ to Bob using only two bits of classical communication. Even though it is required that at some point in time there is a qubit communication between Alice and Bob, one half of the maximally entangled state, this communication can happen Alice even gets the state $\ket{\Psi}$\footnote{and actually it might be Bob who sends a qubit to Alice}, thus it carries no information about $\ket{\Psi}$. 

To describe the protocol, let us define the Bell basis. Let $\ket{\Omega}\in \mathbb{C}^2 \otimes \mathbb{C}^2$ be the maximally entangled state, $\ket{\Omega} = \frac{1}{\sqrt{2}} \ket{00} + \frac{1}{\sqrt{2}} \ket{11}$. Let us define $\ket{\Omega_{\alpha \beta}}$ as $\ket{\Omega_{\alpha\beta}} = (\id \otimes X^\alpha Z^\beta)\ket{\Omega}$, $\alpha,\beta\in \{0,1\}$. Explicitly,
\begin{align*}
  \ket{\Omega_{00}} &= (\id\otimes \id) \ket{\Omega} = \frac{1}{\sqrt{2}} \ket{00} + \frac{1}{\sqrt{2}} \ket{11},\\
  \ket{\Omega_{01}} &= (\id\otimes Z)\ket{\Omega} = \frac{1}{\sqrt{2}} \ket{00} - \frac{1}{\sqrt{2}} \ket{11},\\
  \ket{\Omega_{10}} &= (\id\otimes X)\ket{\Omega} = \frac{1}{\sqrt{2}} \ket{01} + \frac{1}{\sqrt{2}} \ket{10},\\
  \ket{\Omega_{11}} &= (\id\otimes XZ)\ket{\Omega} = \frac{1}{\sqrt{2}} \ket{01} - \frac{1}{\sqrt{2}} \ket{10}.  
\end{align*} 

At the beginning of the protocol, Alice and Bob have the state $\ket{\Psi}\otimes\ket{\Omega}\in \mathcal{H}_{A'} \otimes \mathcal{H}_{A}\otimes \mathcal{H}_B$; in Alice's lab the qubits $A'$ and $A$, in Bob's lab the qubit $B$. The protocol consists of the following steps:
\begin{enumerate}
  \item Alice measures the qubits $A$ and $A'$ in the Bell basis, and obtains outcome $(\alpha,\beta)\in\{0,1\}^2$.
  \item  Alice sends the classical bits $\alpha$ and $\beta$ to Bob
  \item  Bob applies on the particle $B$ the operator $x^\alpha Z^\beta$. 
\end{enumerate}
We will show that at the end of the protocol, Bob obtains the state $\ket{\Psi}$. For that, note the post-measurement state after Alice's measurement, up to normalization, is 
\begin{equation*}
   \ket{\Phi_{\alpha\beta}} = (\ket{\Omega_{\alpha\beta}}\bra{\Omega_{\alpha\beta}} \otimes\id) (\ket{\Psi} \otimes \ket{\Omega}),
\end{equation*}
where the order of the tensor components is $A'AB$. As the measurement is rank-1, the outcome is of the form $\ket{\Phi_{\alpha\beta}} = \ket{\Omega_{\alpha\beta}}\otimes \ket{\Psi_{\alpha\beta}}$, where
\begin{equation*}
     \ket{\Psi_{\alpha\beta}} = (\bra{\Omega_{\alpha\beta}} \otimes\id) (\ket{\Psi} \otimes \ket{\Omega}).
\end{equation*}
 Let us write out now the definition of $\ket{\Omega_{\alpha \beta}}$ in this formula:
\begin{equation*}
  \ket{\Psi_{\alpha\beta}} = (\bra{\Omega_{\alpha\beta}} \otimes\id) (\ket{\Psi} \otimes \ket{\Omega}) = (\bra{\Omega} \otimes\id) (\id \otimes Z^\beta X^\alpha\otimes\id) (\ket{\Psi} \otimes \ket{\Omega}).
\end{equation*}
Using now \cref{prop:max_ent_pull_through}, i.e., that the maximally entangled state satisfies $(A\otimes \id) \cdot \ket{\Omega} = (\id\otimes A^T) \cdot\ket{\Omega}$, for any square matrix $A$, we obtain that 
\begin{equation*}
  \ket{\Psi_{\alpha\beta}} =  (\bra{\Omega} \otimes\id) (\id \otimes Z^\beta X^\alpha \otimes\id) (\ket{\Psi} \otimes \ket{\Omega}) =  (\bra{\Omega} \otimes\id) (\id \otimes \id \otimes X^\alpha Z^\beta ) (\ket{\Psi} \otimes \ket{\Omega}) = X^\alpha Z^\beta\ket{\Psi_{00}},
\end{equation*}
where 
\begin{equation*}
  \ket{\Psi_{00}} =  (\bra{\Omega} \otimes\id) (\ket{\Psi} \otimes \ket{\Omega}).
\end{equation*}
Using now \cref{prop:max_ent_pull_through_lin_fcn} twice, we obtain that
\begin{equation*}
  \ket{\Psi_{00}} =  (\bra{\Omega} \otimes\id) (\ket{\Psi} \otimes \ket{\Omega}) = (\bra{\bar{\Psi}} \otimes\id) \ket{\Omega} = \ket{\Psi}.
\end{equation*}
We thus obtain that the state after Alice's measurement, if she obtains ouctcome $\alpha\beta$, is
\begin{equation*}
  \ket{\Phi_{\alpha\beta}} = \ket{\Omega_{\alpha\beta}}\otimes X^\alpha Z^\beta \ket{\Psi}.
\end{equation*}
Therefore, if Bob applies $Z^\beta X^\alpha$ on his part of the state, he will obtain the state $\ket{\Psi}$ independent of Alice's side.

{\color{red} Break down the measurement into rotation and two single-qubit measurements}


\section{Schmidt decomposition}

\begin{definition}[Schmidt decomposition]
  Let $\mathcal{H},\mathcal{K}$ be Hilbert spaces, $\ket{\Psi}\in\mathcal{H}\otimes \mathcal{K}$. A Schmidt decomposition of $\ket{\Psi}$ is a finite set $\{(\lambda_i, \ket{l_i}, \ket{r_i})\}_{i=1}^n\subseteq \mathbb{C}\times \mathcal{H}\times \mathcal{K}$ such that
  \begin{equation*}
    \ket{\Psi} = \sum_{i=1}^n \lambda_i \cdot \ket{l_i} \otimes \ket{r_i},
  \end{equation*}
  and such that
  \begin{itemize}
  \item  $\lambda_i> 0\ \forall i = 1,\dots, n$,
  \item $\scalprod{l_i}{l_j} = \delta_{ij}$ for all $i,j=1,\dots, n$, and
  \item $\scalprod{r_i}{r_j} = \delta_{ij}$ for all $i,j=1,\dots, n$.
  \end{itemize}
\end{definition}

The vectors $\{\ket{l_i}\}_{i=1}^n$ and $\{(\ket{r_i}\}_{i=1}^n$ are linearly independent, and thus a Schmidt decomposition is a minimal rank decomposition. Not every minimal rank decomposition is a Schmidt decomposition, as there the tensor components are not required to be orthonormal.

\begin{example}
  Consider the following states. 
  \begin{itemize}
    \item $\ket{\Omega} = \frac{1}{\sqrt{2}} \ket{00} + \frac{1}{\sqrt{2}} \ket{11}$. This is a Schmidt decomposition of $\ket{\Omega}$.
    \item The same state admits another Schmidt decomposition: $\ket{\Omega} = \frac{1}{\sqrt{2}} \ket{++} + \frac{1}{\sqrt{2}} \ket{--}$. So the Schmidt decomposition is not unique. Note: the lack of uniqueness is due to the degeneracy of its Schmidt values. 
    \item $\ket{\Psi} = \frac{1}{\sqrt{2}} \ket{+0} + \frac{1}{\sqrt{2}} \ket{11}$ is not a Schmidt decomposition, as $\scalprod{+}{1}\neq 0$.
    \item $\ket{\Phi} = \frac{1}{\sqrt{2}} \ket{+0} + \frac{1}{\sqrt{2}} \ket{-1}$ is a Schmidt decomposition. The basis on the left and on the right is not necessarily the same (they, in general, are even bases of different Hilbert spaces).
  \end{itemize}
\end{example}

\begin{theorem}
  Let $\mathcal{H},\mathcal{K}$ be Hilbert spaces, and $\ket{\Psi}\in\mathcal{H}\otimes \mathcal{K}$, $\ket{\Psi}\neq 0$. Then $\ket{\Psi}$ has a Schmidt decomposition.
\end{theorem}

\begin{proof}
  Let $\rho := \tr_{\mathcal{K}} \ket{\Psi}\bra{\Psi}$. This operator is positive semidefinite, and thus we can consider an eigen decomposition
  \begin{equation}\label{eq:schmidt_existence_eigen}
    \rho = \sum_i \lambda_i^2 \cdot \ket{l_i}\bra{l_i},
  \end{equation}
  with $\lambda_i\in\mathbb{R}$, $\lambda_i\geq 0$ for all $i=1\dots \dim\mathcal{H}$. The vectors $\{\ket{l_i}\}_{i=1}^{\dim \mathcal{H}}$ form a basis of $\mathcal{H}$, we can thus write 
  \begin{equation*}
    \ket{\Psi}  = \sum_i \ket{l_i} \otimes \ket{\hat{r}_i},
  \end{equation*}
  for some $\{\ket{\hat{r}_i}\}_{i=1}^{\dim \mathcal{H}}\subseteq \mathcal{K}$. Expressing $\rho$ with the help of this form of $\ket{\Psi}$, we obtain 
  \begin{equation*}
    \rho = \tr_{\mathcal{K}} \ket{\Psi}\bra{\Psi} = \sum_{i,j=1}^{\dim \mathcal{H}} \ket{l_i}\bra{l_j} \cdot \tr \{ \ket{\hat{r}_i}\bra{\hat{r}_j}\}= \sum_{i,j=1}^{\dim \mathcal{H}} \ket{l_i}\bra{l_j} \cdot \scalprod{\hat{r}_j}{\hat{r}_i}.
  \end{equation*}
  Comparing this to \cref{eq:schmidt_existence_eigen}, we obtain $\scalprod{\hat{r}_j}{\hat{r}_i} = \delta_{ij} \lambda_i^2$. For $\lambda_i\neq 0$ we can thus define  $\ket{r_i} = \lambda_i^{-1} \ket{\hat{r}_i}$. These states are, by definition, orthonormal, and 
  \begin{equation*}
    \ket{\Psi} = \sum_{i: \lambda_i\neq 0} \lambda_i \cdot \ket{l_i} \otimes \ket{r_i}
  \end{equation*}
  is a Schmidt decomposition of $\ket{\Psi}$.
\end{proof}

Consider $\ket{\Psi}\in\mathcal{H}\otimes \mathcal{K}$, and set $\rho_{\mathcal{H}} := \tr_{\mathcal{K}} \ket{\Psi}\bra{\Psi}$ and $\rho_{\mathcal{K}} := \tr_{\mathcal{H}} \ket{\Psi}\bra{\Psi}$. These two matrices -- the reduced densities of the state $\ket{\Psi}$ -- have the same spectrum, except for the eigenvalue $0$: they are both the squared Schmidt values of $\ket{\Psi}$, plus maybe additional zeros.  

\section{LOCC}

The laws of physics are inherently local (gravity might be an interesting exception): that is, only physical systems that are close to each other tend to interact. In our description, this means that if the two components of a bipartite quantum system $AB$ are ``far from each other'', as for example, a pair of atoms located in two different labs, then there are operations that are ``easy'' to do and operations that are ``hard'' to do. While the exact boundary between easy and hard operations depend on the actual physical system, we can assume that \emph{local} operations are easy to do: unitaries that are of the form $U_A\otimes \id_B$ or $\id_A\otimes U_B$, and measurements of the form $\{M_i^A\otimes \id_B\}_{i=1}^n$ and $\{\id\otimes M_i^B\}_{i=1}^n$. Applying a sequence of ``easy'' operations is considered to be ``easy'' again. 

LOCC operations (local operations assisted by classical communication) consist of these local operations, but where we assume in addition that the parties can communicate with each other (by classical means): they can share their measurement outcomes, and thus the subsequent unitaries and measurements of all parties might depend on the measurement outcomes. We have already seen such a protocol: teleportation. 

In this section, we will try to understand when a state $\ket{\Phi}$ can be transformed into another state $\ket{\Psi}$ via LOCC operations; if it is possible, we write $\ket{\Phi}\xrightarrow{LOCC}\ket{\Psi}$. In this case $\ket{\Phi}$ is a better resource for carrying out any task where the parties are restricted by locality, but where they are allowed to communicate: for example, when they want to carry out an experiment on a collection of entangled particles where the particles are located in different labs. 


%We want to understand which states are more entangled than others. Our strategy: identify a sufficiently large class of operations that we declare not to increase entanglement, then we say that $\ket{\Psi}$ is more entangled than $\ket{\Phi}$ iff we can transform $\ket{\Psi}$ to $\ket{\Phi}$ via those operations. To botain this class of operations, consider the following scenario:

%This large class of operations is every thing that the parties can do using only local operations (that is, measurements and unitaries) but where they are allowed to share classical information with each other.

%Which operations shall we choose? Quantum operations of (pure) states, thus they will consist of unitaries and measurements. Minimal requirement: do not transform separable states to entangled states. Unitaries are easy. Only product unitaries are allowed, as
%\begin{proposition}
%  Let $U\in \bounded{\mathcal{H}\otimes\mathcal{K}}$. Then $U (\ket{\psi} \otimes \ket{\phi})$ is a product state for all $\ket{\psi}\in\mathcal{H}$, $\ket{\phi}\in\mathcal{K}$, if and only if $U$ is a product, i.e., there are $V\in\bounded{\mathcal{H}}$ and $ W\in \bounded{\mathcal{K}}$ unitaries such that $U = V\otimes W$ .
%\end{proposition}
%\begin{proof} Exercise.
%  %If $U = V\otimes W$, then $U (\ket{\psi} \otimes \ket{\phi}) = V\ket{\psi} \otimes W\ket{\phi}$, it is a product state. If $U (\ket{\psi} \otimes \ket{\phi}) = \ket{\psi'} \otimes \ket{\phi'}$, for all $\ket{\psi}$ and $\ket{\phi}$, then due to linearity of the l.h.s.,  
%\end{proof}
%For measurements, a similar statement holds: if we want \emph{all} measurement outcomes to be separable for a pure separable  input, then the measurement operators are products. In LOCC we include only  
\begin{theorem}[Ky-Fan]\label{thm:Ky-Fan}
  Let $\mathcal{H}$ be a Hilbert space, $k\in\mathbb{N}$, and 
  \begin{equation*}
    \mathcal{P}_k(\mathcal{H}):= \left\{ P\in\bounded{\mathcal{H}} \middle|  P = P^\dagger = P^2,\ \tr(P)=k\right\}.
  \end{equation*}
  Let $\rho\in \bounded{\mathcal{H}}$ Hermitian, and 
  \begin{equation*}
    \rho = \sum_{i=1}^{\dim\mathcal{H}} \lambda_i \ket{\Phi_i}\bra{\Phi_i}
  \end{equation*}
  be its eigen decomposition, with $\lambda_1 \geq \lambda_2 \geq \dots \geq \lambda_{\dim \mathcal{H}}$. Then 
  \begin{equation*}
    \sup_{P\in\mathcal{P}_k} \tr\{\rho P\} = \sum_{i=1}^k \lambda_i.
  \end{equation*}
\end{theorem}

In other words, given a Hermitian operator $\rho$, the maximum of $\tr\{\rho P\}$, where $P$ is a rank-$k$ Hermitian projector, is the sum of the $k$ largest eigenvalues of $\rho$.

\begin{proof}
    Let $Q  = \sum_i \ket{\Phi_i}\bra{\Phi_i}$. Then $Q\in\mathcal{P}_k$ and thus 
    \begin{equation}\label{eq:ky-fan-lower}
      \sup_{P\in\mathcal{P}_k}\tr\{\rho P\}  \geq \tr\{Q\rho\} = \sum_{i=1}^k \bra{\Phi_i}\rho \ket{\Phi_i} = \sum_{i=1}^k \lambda_i.
    \end{equation}
  To obtain the opposite bound, use the spectral decomposition of $\rho$ to write 
  \begin{equation*}
    \tr\{\rho P\} = \sum_{i=1}^{\dim\mathcal{H}} \lambda_i \tr\left\{ P \ket{\Phi_i}\bra{\Phi_i} \right\}= \sum_{i=1}^{\dim \mathcal{H}} \lambda_i \cdot \bra{\Phi_i} P \ket{\Phi_i} =  \sum_{i=1}^{\dim \mathcal{H}} \lambda_i \cdot \omega_i,
  \end{equation*}
  where $\omega_i = \bra{\Phi_i} P \ket{\Phi_i}$ satisfies $0\leq \omega_i\leq 1$ and $\sum_{i=1}^k \omega_i = k$. We thus obtain that 
  \begin{equation*}
    \sup_{P\in\mathcal{P}_k}\tr\{\rho P\} \leq \sup_{\substack{\omega\in [0,1]^{\dim \mathcal{H}}\\ \sum_i \omega_i =k}}  \sum_{i=1}^{\dim \mathcal{H}} \lambda_i \cdot \omega_i.
  \end{equation*}
  The maximum of the r.h.s.\ is reached at $\omega_1 = \dots = \omega_k = 1$, and $\omega_{k+1} = \dots = \omega_{\dim\mathcal{H}} = 0$, and its value is $\sum_{i=1}^k \lambda_i$.  Therefore
  \begin{equation*}
    \sup_{P\in\mathcal{P}_k}\tr\{\rho P\} \leq \sup_{\substack{\omega\in [0,1]^{\dim \mathcal{H}}\\ \sum_i \omega_i =k}}  \sum_{i=1}^{\dim \mathcal{H}} \lambda_i \cdot \omega_i = \sum_{i=1}^k \lambda_i.
  \end{equation*}
 This, together with \cref{eq:ky-fan-lower} is the desired statement.
\end{proof}

\begin{definition}[Majorization]
  Let $p,q\in\mathbb{R}^n$ be probability distributions. Let $p^\downarrow$ ($q^\downarrow$) be the vector obtained by listing the entries of $p$ ($q$) in descending order. We say that $p$ is majorized by $q$, and write $p\preccurlyeq q$, if for all $k=1,\dots, n$,
  \begin{equation*}
    \sum_{i=1}^k p^\downarrow_i \leq \sum_{i=1}^k q^\downarrow_i. 
  \end{equation*} 
\end{definition}

{\color{red} TODO: Here it is better to define Schmidt coefficient with zero in it.}

\begin{proposition}\label{prop:LOCC=>majorization}
  Let $\ket{\Psi},\ket{\Phi}\in \mathcal{H}\otimes \mathcal{K}$. Let the squared Schmidt coefficients of $\ket{\Psi}$ be $p$, and the squared Schmidt coefficients of $\ket{\Phi}$ be $q$.  If $\ket{\Psi} \xrightarrow{LOCC} \ket{\Psi}$, then $q\preccurlyeq p$.
\end{proposition}

\begin{proof}
  Let $\rho = \tr_{\mathcal{H}}\ket{\Psi}\bra{\Psi}$ and $\eta = \tr_{\mathcal{H}}\ket{\Psi}\bra{\Psi}$. Then the eigenvalues of $\rho$ are precisely the entries of $p$ and the eigenvalues of $\eta$ are the entries of $q$.  Using {\color{red} MISSING},  $\ket{\Psi} \xrightarrow{LOCC} \ket{\Psi}$ if and only if
  \begin{equation*}
    \sqrt{r_i}\ket{\Phi} = M_i \otimes U_i \ket{\Psi},
  \end{equation*}
  for a measurement $\{M_i\}_{i=1}^n$, a probability distribution $r\in\mathbb{R}^n$ and some unitaries $\{U_i\}_{i=1}^n$. Therefore
  \begin{equation*}
    r_i \eta = U_i \rho_i U_i^\dagger,
  \end{equation*} 
  where $\rho_i = \tr_{\mathcal{H}} \{ (M_i^\dagger M_i \otimes \id)\ket{\Psi}\bra{\Psi}\}$,  and thus 
  \begin{equation*}
    \sup_{P\in\mathcal{P}_k} \tr\{P \eta\} = \sup_{P\in\mathcal{P}_k} \sum_i  \tr\{r_i P \eta\} = \sup_{P\in\mathcal{P}_k} \sum_i \tr\{PU_i \rho_i U_i^\dagger \} \leq \sum_i \sup_{P\in\mathcal{P}_k} \tr\{U_i^\dagger P U_i \rho\} = \sum_i \sup_{P\in\mathcal{P}_k} \tr\{P \rho_i\} = \sup_{P\in\mathcal{P}_k} \tr\{P\rho\}.  
  \end{equation*}
  Using now \cref{thm:Ky-Fan}, we obtain that $p\preccurlyeq q$.
\end{proof}


Let us try to understand now a \emph{sufficient} criterion for $\ket{\Psi}\xrightarrow{LOCC}\ket{\Phi}$. 

\begin{example}
  Let $\ket{\Psi} =  \sqrt{1/2} \ket{00} + \sqrt{1/2}\ket{11}$ and $\ket{\Phi} = \sqrt{2/3} \ket{00} + \sqrt{1/3}\ket{11}$. Notice that 
  \begin{equation*}
    M_0 = \left( \begin{matrix}
      \sqrt{2/3} & 0 \\ 0 & \sqrt{1/3}
    \end{matrix} \right),
  \end{equation*}
  is a matrix such that $(M_0\otimes \id) \ket{\Psi} = \ket{\Phi}$. Moreover, we can complete it to a measurement, for example,  with the matrix
  \begin{equation*}
    M_1 = \left( \begin{matrix}
      \sqrt{1/3} & 0 \\ 0 & \sqrt{2/3}
    \end{matrix} \right),
  \end{equation*}
  i.e., $M_0^\dagger M_0 + M_1^\dagger M_1  = \id$.  Notice that $(M_1\otimes \id) \ket{\Psi} = X\otimes X\ket{\Phi}$. Therefore the measurement $N_i = X^i M_i$ ($i=1,2$) is such that 
  \begin{equation*}
    M_i \otimes X^i \ket{\Psi} = \sqrt{p_i} \ket{\Phi},
  \end{equation*}
  for some probability distribution $p_i$, i.e., $\ket{\Psi}\xrightarrow{LOCC}\ket{\Phi}$.
\end{example}
The essence of this example is that the squared Schmidt coefficients of the states are related to each other as
\begin{equation*}
   \left(\begin{matrix} 1/2 \\ 1/2 \end{matrix}\right) = \frac{1}{2} \cdot (\id + X) \cdot \left(\begin{matrix} 1/3 \\ 2/3 \end{matrix}\right).
\end{equation*}
This construction can be easily generalized for the case when the squared Schmidt coefficients of $\ket{\Psi}$ can be obtained by mixing permutations of the squared Schmidt coefficients of $\ket{\Phi}$. Before we show how to obtain the LOCC operations for this generalized case, notice that this constraint is equivalent with majorization:


\begin{lemma}\label{lem:majorization=>mixing_permutation}
  Let $p,q\in\mathbb{R}^n$ be probability distributions. If $p\preccurlyeq q$, then there is a probability distribution $r\in\mathbb{R}^{n!}$ such that 
  \begin{equation*}
    p  = \sum_{\pi \in S_n} r_{\pi} \pi q,
  \end{equation*}
  where $S_n\subseteq \bounded{\mathbb{R}^n}$ is the set of $n\times n$ permutation matrices. 
\end{lemma}

\begin{proof}
  Exercise.
\end{proof}

{\color{red} Again, number of non-zero Schmidt coeffs might be different!}
\begin{proposition}\label{prop:majorization=>LOCC}
  Let $\ket{\Psi},\ket{\Phi}\in \mathcal{H}\otimes \mathcal{K}$. Let the squared Schmidt coefficients of $\ket{\Psi}$ be $p$, and the squared Schmidt coefficients of $\ket{\Phi}$ be $q$. If $p\preccurlyeq q$, then $\ket{\Psi}\xrightarrow{LOCC}\ket{\Phi}$. 
\end{proposition}

\begin{proof}
  Using \cref{lem:majorization=>mixing_permutation}, we obtain that there is a probability distribution $r$ such that $p  = \sum_{\pi \in S_n} r_{\pi} \pi q$, where $S_n$ is the group of $n\times n$ permutation matrices. Let the Schmidt decomposition of the states be 
  \begin{align*}
    \ket{\Psi} = \sum_{i=1}^n p_i \cdot \ket{l_i} \otimes \ket{r_i}\\
    \ket{\Phi} = \sum_{i=1}^n q_i \cdot \ket{\hat{l}_i} \otimes \ket{\hat{r}_i},    
  \end{align*}
  and let us define operators $M_{\pi}$ as 
  \begin{equation*}
    M_{\pi} = \sum_i \left( r_\pi \frac{q_{\pi(i)}}{p_i}\right)^{1/2} \ket{\hat{l}_{\pi(i)}} \bra{l_i}. 
  \end{equation*}
  These operators form a POVM as
  \begin{equation*}
    \sum_{\pi} M_\pi^\dagger M_\pi = \sum_{ij}\sum_\pi  r_\pi \frac{q_{\pi(i)}}{p_i} \ket{l_i}\scalprod{\hat{l}_{\pi(i)}}{\hat{l}_{\pi(j)}}\bra{l_j} = \sum_{i}\sum_\pi  r_\pi \frac{q_{\pi(i)}}{p_i} \ket{l_i}\bra{l_i}  = \sum_{i} \ket{l_i}\bra{l_i}  = \id.
  \end{equation*}
  Note as well that 
  \begin{equation*}
    (M_\pi \otimes \id) \ket{\Psi} = \sum_i  \sqrt{r_\pi q_{\pi(i)}} \ket{\hat{l}_{\pi(i)}}\otimes \ket{r_i}, 
  \end{equation*}
  and thus, setting $V_{\pi} = \sum_i \ket{r_{\pi(i)}}\bra{r_i}$, $V_\pi$ is a unitary and 
  \begin{equation*}
    (M_\pi \otimes V_\pi) \ket{\Psi} = \sum_i  \sqrt{r_\pi q_{\pi(i)}} \ket{\hat{l}_{\pi(i)}}\otimes \ket{r_{\pi(i)}} = \sqrt{r_\pi} \ket{\Phi}, 
  \end{equation*}
  i.e., we have shown that $\ket{\Psi}\xrightarrow{LOCC}\ket{\Phi}$.
\end{proof}

We have thus seen in \cref{prop:LOCC=>majorization} and \cref{prop:majorization=>LOCC} that
\begin{theorem}
  Let $\ket{\Psi},\ket{\Phi}\in \mathcal{H}\otimes \mathcal{K}$. Let the squared Schmidt coefficients of $\ket{\Psi}$ be $p$, and the squared Schmidt coefficients of $\ket{\Phi}$ be $q$. Then $\ket{\Psi}\xrightarrow{LOCC}\ket{\Phi}$ iff  $p\preccurlyeq q$.   
\end{theorem}

\end{document}
