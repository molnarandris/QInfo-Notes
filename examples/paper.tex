\documentclass{article}
\usepackage[utf8]{inputenc}
\usepackage{fullpage}
\usepackage{amsthm,amsmath,amssymb}
\usepackage{tikz}
\usepackage[hidelinks,draft=false,colorlinks=true]{hyperref}
\usepackage[capitalize]{cleveref} % after hyperref!
\usepackage{mathtools}  % for extendible arrows with text above 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% For bibliography
\usepackage[sorting=none, backend=biber, url=false, isbn=false, hyperref=true, eprint=true, maxbibnames=6]{biblatex}
\addbibresource{/home/molnar/Dropbox/ZoteroLibrary.bib}
\AtEveryBibitem{%
	\clearfield{eprintclass}%
}

% Setting title to point to doi link
\ExecuteBibliographyOptions{doi=false}
\newbibmacro{string+doi}[1]{%
	\iffieldundef{doi}{#1}{\href{http://dx.doi.org/\thefield{doi}}{#1}}}
\DeclareFieldFormat{title}{\usebibmacro{string+doi}{\mkbibemph{#1}}}
\DeclareFieldFormat[article]{title}{\usebibmacro{string+doi}{\mkbibquote{#1}}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% hyperref setup
\hypersetup{
	pdftitle={Quantum information lecture notes},
	pdfauthor={Andras Molnar},
	bookmarks=true,
	bookmarksnumbered=true,
	bookmarksopen=true,
	bookmarksopenlevel=1,
	colorlinks,
	%linkcolor=blue!50!black,
	%urlcolor=cyan!50!black!90,
	pdfstartview=Fit,
	pdfpagemode=UseOutlines,    
	pdfpagelayout=TwoPageRight
}

\newtheorem{lemma}{Lemma}
\newtheorem{fact}{Fact}
\newtheorem{proposition}{Proposition}
\newtheorem{theorem}{Theorem}
\newtheorem{corollary}{Corollary}
\newtheorem{remark}{Remark}
\newtheorem{definition}{Definition}
\newtheorem{exercise}{Exercise}
\theoremstyle{definition}
\newtheorem{example}{Example}


\newcommand{\tr}{\operatorname{Tr}}
\newcommand{\id}{\mathrm{Id}}
\newcommand{\todo}[1]{{\color{red} #1}}
\newcommand{\myfcn}{nice }
\newcommand{\myfcntwo}{admissible }
\newcommand{\End}{\mathrm{End}}
\newcommand{\ket}[1]{\vert #1 \rangle}
\newcommand{\bra}[1]{\langle #1 \vert}
\newcommand{\scalprod}[2]{\langle #1 \vert #2 \rangle}
\newcommand{\Span}{\mathrm{Span}}
\newcommand{\bounded}[1]{\mathcal{B}(#1)}

\title{Quantum Information}
\author{Andras Molnar}

\begin{document}

\maketitle

\begin{remark}
  In this note all Hilbert spaces are complex and finite dimensional unless otherwise stated.
\end{remark}

\section{Schmidt decomposition}

\begin{definition}[Schmidt decomposition]
  Let $\mathcal{H},\mathcal{K}$ be Hilbert spaces, $\ket{\Psi}\in\mathcal{H}\otimes \mathcal{K}$. A Schmidt decomposition of $\ket{\Psi}$ is a finite set $\{(\lambda_i, \ket{l_i}, \ket{r_i})\}_{i=1}^n\subseteq \mathbb{C}\times \mathcal{H}\times \mathcal{K}$ such that
  \begin{equation*}
    \ket{\Psi} = \sum_{i=1}^n \lambda_i \cdot \ket{l_i} \otimes \ket{r_i},
  \end{equation*}
  and such that
  \begin{itemize}
  \item  $\lambda_i> 0\ \forall i = 1,\dots, n$,
  \item $\scalprod{l_i}{l_j} = \delta_{ij}$ for all $i,j=1,\dots, n$, and
  \item $\scalprod{r_i}{r_j} = \delta_{ij}$ for all $i,j=1,\dots, n$.
  \end{itemize}
\end{definition}

\begin{theorem}
  Let $\mathcal{H},\mathcal{K}$ be Hilbert spaces, and $\ket{\Psi}\in\mathcal{H}\otimes \mathcal{K}$, $\ket{\Psi}\neq 0$. Then $\ket{\Psi}$ has a Schmidt decomposition.
\end{theorem}

\begin{proof}
  Let $\rho := \tr_{\mathcal{K}} \ket{\Psi}\bra{\Psi}$. This operator is positive semidefinite, and thus we can consider an eigen decomposition
  \begin{equation}\label{eq:schmidt_existence_eigen}
    \rho = \sum_i \lambda_i^2 \cdot \ket{l_i}\bra{l_i},
  \end{equation}
  with $\lambda_i\in\mathbb{R}$, $\lambda_i\geq 0$ for all $i=1\dots \dim\mathcal{H}$. The vectors $\{\ket{l_i}\}_{i=1}^{\dim \mathcal{H}}$ form a basis of $\mathcal{H}$, we can thus write 
  \begin{equation*}
    \ket{\Psi}  = \sum_i \ket{l_i} \otimes \ket{\hat{r}_i},
  \end{equation*}
  for some $\{\ket{\hat{r}_i}\}_{i=1}^{\dim \mathcal{H}}\subseteq \mathcal{K}$. Expressing $\rho$ with the help of this form of $\ket{\Psi}$, we obtain 
  \begin{equation*}
    \rho = \tr_{\mathcal{K}} \ket{\Psi}\bra{\Psi} = \sum_{i,j=1}^{\dim \mathcal{H}} \ket{l_i}\bra{l_j} \cdot \tr \{ \ket{\hat{r}_i}\bra{\hat{r}_j}\}= \sum_{i,j=1}^{\dim \mathcal{H}} \ket{l_i}\bra{l_j} \cdot \scalprod{\hat{r}_j}{\hat{r}_i}.
  \end{equation*}
  Comparing this to \cref{eq:schmidt_existence_eigen}, we obtain $\scalprod{\hat{r}_j}{\hat{r}_i} = \delta_{ij} \lambda_i^2$. For $\lambda_i\neq 0$ we can thus define  $\ket{r_i} = \lambda_i^{-1} \ket{\hat{r}_i}$. These states are, by definition, orthonormal, and 
  \begin{equation*}
    \ket{\Psi} = \sum_{i: \lambda_i\neq 0} \lambda_i \cdot \ket{l_i} \otimes \ket{r_i}
  \end{equation*}
  is a Schmidt decomposition of $\ket{\Psi}$.
\end{proof}

\section{LOCC}

We want to understand which states are more entangled than others. Our strategy: identify a sufficiently large class of operations (this will be LOCC) that we declare not to increase entanglement, then we say that $\ket{\Psi}$ is more entangled than $\ket{\Phi}$ iff we can transform $\ket{\Psi}$ to $\ket{\Phi}$ via those operations.  

Which operations shall we choose? Quantum operations of (pure) states, thus they will consist of unitaries and measurements. Minimal requirement: do not transform separable states to entangled states. Unitaries are easy. Only product unitaries are allowed, as
\begin{proposition}
  Let $U\in \bounded{\mathcal{H}\otimes\mathcal{K}}$. Then $U (\ket{\psi} \otimes \ket{\phi})$ is a product state for all $\ket{\psi}\in\mathcal{H}$, $\ket{\phi}\in\mathcal{K}$, if and only if $U$ is a product, i.e., there are $V\in\bounded{\mathcal{H}}$ and $ W\in \bounded{\mathcal{K}}$ unitaries such that $U = V\otimes W$ .
\end{proposition}
\begin{proof} Exercise.
  %If $U = V\otimes W$, then $U (\ket{\psi} \otimes \ket{\phi}) = V\ket{\psi} \otimes W\ket{\phi}$, it is a product state. If $U (\ket{\psi} \otimes \ket{\phi}) = \ket{\psi'} \otimes \ket{\phi'}$, for all $\ket{\psi}$ and $\ket{\phi}$, then due to linearity of the l.h.s.,  
\end{proof}

\begin{theorem}[Ky-Fan]\label{thm:Ky-Fan}
  Let $\mathcal{H}$ be a Hilbert space, $k\in\mathbb{N}$, and 
  \begin{equation*}
    \mathcal{P}_k(\mathcal{H}):= \left\{ P\in\bounded{\mathcal{H}} \middle|  P = P^\dagger = P^2,\ \tr(P)=k\right\}.
  \end{equation*}
  Let $\rho\in \bounded{\mathcal{H}}$ Hermitian, and 
  \begin{equation*}
    \rho = \sum_{i=1}^{\dim\mathcal{H}} \lambda_i \ket{\Phi_i}\bra{\Phi_i}
  \end{equation*}
  be its eigen decomposition, with $\lambda_1 \geq \lambda_2 \geq \dots \geq \lambda_{\dim \mathcal{H}}$. Then 
  \begin{equation*}
    \sup_{P\in\mathcal{P}_k} \tr\{\rho P\} = \sum_{i=1}^k \lambda_i.
  \end{equation*}
\end{theorem}

In other words, given a Hermitian operator $\rho$, the maximum of $\tr\{\rho P\}$, where $P$ is a rank-$k$ Hermitian projector, is the sum of the $k$ largest eigenvalues of $\rho$.

\begin{proof}
    Let $Q  = \sum_i \ket{\Phi_i}\bra{\Phi_i}$. Then $Q\in\mathcal{P}_k$ and thus 
    \begin{equation}\label{eq:ky-fan-lower}
      \sup_{P\in\mathcal{P}_k}\tr\{\rho P\}  \geq \tr\{Q\rho\} = \sum_{i=1}^k \bra{\Phi_i}\rho \ket{\Phi_i} = \sum_{i=1}^k \lambda_i.
    \end{equation}
  To obtain the opposite bound, use the spectral decomposition of $\rho$ to write 
  \begin{equation*}
    \tr\{\rho P\} = \sum_{i=1}^{\dim\mathcal{H}} \lambda_i \tr\left\{ P \ket{\Phi_i}\bra{\Phi_i} \right\}= \sum_{i=1}^{\dim \mathcal{H}} \lambda_i \cdot \bra{\Phi_i} P \ket{\Phi_i} =  \sum_{i=1}^{\dim \mathcal{H}} \lambda_i \cdot \omega_i,
  \end{equation*}
  where $\omega_i = \bra{\Phi_i} P \ket{\Phi_i}$ satisfies $0\leq \omega_i\leq 1$ and $\sum_{i=1}^k \omega_i = k$. We thus obtain that 
  \begin{equation*}
    \sup_{P\in\mathcal{P}_k}\tr\{\rho P\} \leq \sup_{\substack{\omega\in [0,1]^{\dim \mathcal{H}}\\ \sum_i \omega_i =k}}  \sum_{i=1}^{\dim \mathcal{H}} \lambda_i \cdot \omega_i.
  \end{equation*}
  The maximum of the r.h.s.\ is reached at $\omega_1 = \dots = \omega_k = 1$, and $\omega_{k+1} = \dots = \omega_{\dim\mathcal{H}} = 0$, and its value is $\sum_{i=1}^k \lambda_i$.  Therefore
  \begin{equation*}
    \sup_{P\in\mathcal{P}_k}\tr\{\rho P\} \leq \sup_{\substack{\omega\in [0,1]^{\dim \mathcal{H}}\\ \sum_i \omega_i =k}}  \sum_{i=1}^{\dim \mathcal{H}} \lambda_i \cdot \omega_i = \sum_{i=1}^k \lambda_i.
  \end{equation*}
 This, together with \cref{eq:ky-fan-lower} is the desired statement.
\end{proof}

\begin{definition}[Majorization]
  Let $p,q\in\mathbb{R}^n$ be probability distributions. Let $p^\downarrow$ ($q^\downarrow$) be the vector obtained by listing the entries of $p$ ($q$) in descending order. We say that $p$ is majorized by $q$, and write $p\preccurlyeq q$, if for all $k=1,\dots, n$,
  \begin{equation*}
    \sum_{i=1}^k p^\downarrow_i \leq \sum_{i=1}^k q^\downarrow_i. 
  \end{equation*} 
\end{definition}

{\color{red} TODO: Here it is better to define Schmidt coefficient with zero in it.}

\begin{proposition}
  Let $\ket{\Psi},\ket{\Phi}\in \mathcal{H}\otimes \mathcal{K}$. Let the squared Schmidt coefficients of $\ket{\Psi}$ be $p$, and the squared Schmidt coefficients of $\ket{\Phi}$ be $q$.  If $\ket{\Psi} \xrightarrow{LOCC} \ket{\Psi}$, then $q\preccurlyeq p$.
\end{proposition}

\begin{proof}
  Let $\rho = \tr_{\mathcal{H}}\ket{\Psi}\bra{\Psi}$ and $\eta = \tr_{\mathcal{H}}\ket{\Psi}\bra{\Psi}$. Then the eigenvalues of $\rho$ are precisely the entries of $p$ and the eigenvalues of $\eta$ are the entries of $q$.  Using {\color{red} MISSING},  $\ket{\Psi} \xrightarrow{LOCC} \ket{\Psi}$ if and only if
  \begin{equation*}
    \sqrt{r_i}\ket{\Phi} = M_i \otimes U_i \ket{\Psi},
  \end{equation*}
  for a measurement $\{M_i\}_{i=1}^n$, a probability distribution $r\in\mathbb{R}^n$ and some unitaries $\{U_i\}_{i=1}^n$. Therefore
  \begin{equation*}
    r_i \eta = U_i \rho_i U_i^\dagger,
  \end{equation*} 
  where $\rho_i = \tr_{\mathcal{H}} \{ (M_i^\dagger M_i \otimes \id)\ket{\Psi}\bra{\Psi}\}$,  and thus 
  \begin{equation*}
    \sup_{P\in\mathcal{P}_k} \tr\{P \eta\} = \sup_{P\in\mathcal{P}_k} \sum_i  \tr\{r_i P \eta\} = \sup_{P\in\mathcal{P}_k} \sum_i \tr\{PU_i \rho_i U_i^\dagger \} \leq \sum_i \sup_{P\in\mathcal{P}_k} \tr\{U_i^\dagger P U_i \rho\} = \sum_i \sup_{P\in\mathcal{P}_k} \tr\{P \rho_i\} = \sup_{P\in\mathcal{P}_k} \tr\{P\rho\}.  
  \end{equation*}
  Using now \cref{thm:Ky-Fan}, we obtain that $p\preccurlyeq q$.
\end{proof}


Let us try to understand now a \emph{sufficient} criterion for $\ket{\Psi}\xrightarrow{LOCC}\ket{\Phi}$. 

\begin{example}
  Let $\ket{\Psi} =  \sqrt{1/2} \ket{00} + \sqrt{1/2}\ket{11}$ and $\ket{\Phi} = \sqrt{2/3} \ket{00} + \sqrt{1/3}\ket{11}$. Notice that 
  \begin{equation*}
    M_0 = \left( \begin{matrix}
      \sqrt{2/3} & 0 \\ 0 & \sqrt{1/3}
    \end{matrix} \right),
  \end{equation*}
  is a matrix such that $(M_0\otimes \id) \ket{\Psi} = \ket{\Phi}$. Moreover, we can complete it to a measurement, for example,  with the matrix
  \begin{equation*}
    M_1 = \left( \begin{matrix}
      \sqrt{1/3} & 0 \\ 0 & \sqrt{2/3}
    \end{matrix} \right),
  \end{equation*}
  i.e., $M_0^\dagger M_0 + M_1^\dagger M_1  = \id$.  Notice that $(M_1\otimes \id) \ket{\Psi} = X\otimes X\ket{\Phi}$. Therefore the measurement $N_i = X^i M_i$ ($i=1,2$) is such that 
  \begin{equation*}
    M_i \otimes X^i \ket{\Psi} = \sqrt{p_i} \ket{\Phi},
  \end{equation*}
  for some probability distribution $p_i$, i.e., $\ket{\Psi}\xrightarrow{LOCC}\ket{\Phi}$.
\end{example}
The essence of this example is that the squared Schmidt coefficients of the states are related to each other as
\begin{equation*}
   \left(\begin{matrix} 1/2 \\ 1/2 \end{matrix}\right) = \frac{1}{2} \cdot (\id + X) \cdot \left(\begin{matrix} 1/3 \\ 2/3 \end{matrix}\right).
\end{equation*}
This construction can be easily generalized for the case when the squared Schmidt coefficients of $\ket{\Psi}$ can be obtained by mixing permutations of the squared Schmidt coefficients of $\ket{\Phi}$. Before we show how to obtain the LOCC operations for this generalized case, notice that this constraint is equivalent with majorization:


\begin{lemma}\label{lem:majorization=>mixing_permutation}
  Let $p,q\in\mathbb{R}^n$ be probability distributions. If $p\preccurlyeq q$, then there is a probability distribution $r\in\mathbb{R}^{n!}$ such that 
  \begin{equation*}
    p  = \sum_{\pi \in S_n} r_{\pi} \pi q,
  \end{equation*}
  where $S_n\subseteq \bounded{\mathbb{R}^n}$ is the set of $n\times n$ permutation matrices. 
\end{lemma}

\begin{proof}
  Exercise.
\end{proof}

{\color{red} Again, number of non-zero Schmidt coeffs might be different!}
\begin{proposition}
  Let $\ket{\Psi},\ket{\Phi}\in \mathcal{H}\otimes \mathcal{K}$. Let the squared Schmidt coefficients of $\ket{\Psi}$ be $p$, and the squared Schmidt coefficients of $\ket{\Phi}$ be $q$. If $p\preccurlyeq q$, then $\ket{\Psi}\xrightarrow{LOCC}\ket{\Phi}$. 
\end{proposition}

\begin{proof}
  Using \cref{lem:majorization=>mixing_permutation}, we obtain that there is a probability distribution $r$ such that $p  = \sum_{\pi \in S_n} r_{\pi} \pi q$, where $S_n$ is the group of $n\times n$ permutation matrices. Let the Schmidt decomposition of the states be 
  \begin{align*}
    \ket{\Psi} = \sum_{i=1}^n p_i \cdot \ket{l_i} \otimes \ket{r_i}\\
    \ket{\Phi} = \sum_{i=1}^n q_i \cdot \ket{\hat{l}_i} \otimes \ket{\hat{r}_i},    
  \end{align*}
  and let us define operators $M_{\pi}$ as 
  \begin{equation*}
    M_{\pi} = \sum_i \left( r_\pi \frac{q_{\pi(i)}}{p_i}\right)^{1/2} \ket{\hat{l}_{\pi(i)}} \bra{l_i}. 
  \end{equation*}
  These operators form a POVM as
  \begin{equation*}
    \sum_{\pi} M_\pi^\dagger M_\pi = \sum_{ij}\sum_\pi  r_\pi \frac{q_{\pi(i)}}{p_i} \ket{l_i}\scalprod{\hat{l}_{\pi(i)}}{\hat{l}_{\pi(j)}}\bra{l_j} = \sum_{i}\sum_\pi  r_\pi \frac{q_{\pi(i)}}{p_i} \ket{l_i}\bra{l_i}  = \sum_{i} \ket{l_i}\bra{l_i}  = \id.
  \end{equation*}
  Note as well that 
  \begin{equation*}
    (M_\pi \otimes \id) \ket{\Psi} = \sum_i  \sqrt{r_\pi q_{\pi(i)}} \ket{\hat{l}_{\pi(i)}}\otimes \ket{r_i}, 
  \end{equation*}
  and thus, setting $V_{\pi} = \sum_i \ket{r_{\pi(i)}}\bra{r_i}$, $V_\pi$ is a unitary and 
  \begin{equation*}
    (M_\pi \otimes V_\pi) \ket{\Psi} = \sum_i  \sqrt{r_\pi q_{\pi(i)}} \ket{\hat{l}_{\pi(i)}}\otimes \ket{r_{\pi(i)}} = \sqrt{r_\pi} \ket{\Phi}, 
  \end{equation*}
  i.e., we have shown that $\ket{\Psi}\xrightarrow{LOCC}\ket{\Phi}$.
\end{proof}

We have thus seen that
\begin{theorem}
  Let $\ket{\Psi},\ket{\Phi}\in \mathcal{H}\otimes \mathcal{K}$. Let the squared Schmidt coefficients of $\ket{\Psi}$ be $p$, and the squared Schmidt coefficients of $\ket{\Phi}$ be $q$. Then $\ket{\Psi}\xrightarrow{LOCC}\ket{\Phi}$ iff  $p\preccurlyeq q$.   
\end{theorem}

\end{document}
